<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Graph Analyzer - Network Optimization</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <div id="loginScreen" class="login-screen">
            <h2>Selecciona tu usuario</h2>
            <div class="user-select">
                <div class="user-card" onclick="login('Otro')">
                    üë§ Otro
                </div>
                <div class="user-card" onclick="login('Edu')">
                    üë§ Edu
                </div>
            </div>
        </div>

        <div id="appScreen" class="hidden">
            <div class="header">
                <h1>üï∏Ô∏è Social Graph Analyzer</h1>
                <div class="user-info">User: <span id="currentUser"></span></div>
                <button class="logout-btn" onclick="logout()">Cerrar Sesi√≥n</button>
            </div>

            <div class="main-content">
                <div class="nav-tabs">
                    <button class="tab active" onclick="showTab('nodes')">üë• Nodos</button>
                    <button class="tab" onclick="showTab('events')">üìÖ Eventos</button>
                    <button class="tab" onclick="showTab('network')">üï∏Ô∏è Red</button>
                    <button class="tab" onclick="showTab('analytics')">üìä Analytics</button>
                    <button class="tab" onclick="showTab('spawn')">üéØ High-Value Zones</button>
                    <button class="tab" onclick="showTab('profile')">‚öôÔ∏è Mi Perfil</button>
                </div>

                <div id="nodesTab" class="tab-content active">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                        <h2>Gesti√≥n de Nodos (Personas)</h2>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-small" onclick="exportNodes()">üì• Export CSV</button>
                            <button class="btn" onclick="openNodeModal()">‚ûï Nuevo Nodo</button>
                        </div>
                    </div>
                    <div id="nodesList"></div>
                </div>

                <div id="eventsTab" class="tab-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                        <h2>Event Logs</h2>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-small" onclick="exportEvents()">üì• Export CSV</button>
                            <button class="btn btn-small" onclick="exportAllData()">üì¶ Export All (JSON)</button>
                            <button class="btn" onclick="openEventModal()">‚ûï Nuevo Evento</button>
                        </div>
                    </div>
                    <div id="eventsList"></div>
                </div>

                <div id="networkTab" class="tab-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2>Visualizaci√≥n de Red Social</h2>
                        <button class="btn btn-small" onclick="refreshNetwork()">üîÑ Actualizar</button>
                    </div>
                    <canvas id="networkCanvas" width="1200" height="600" style="border: 1px solid #ddd; border-radius: 10px; background: #f9f9f9; width: 100%; max-width: 1200px;"></canvas>
                    <div style="margin-top: 20px; padding: 15px; background: #f0f0f0; border-radius: 8px;">
                        <strong>Leyenda:</strong>
                        <span style="margin-left: 20px;">üî¥ Alto Valor Rom√°ntico</span>
                        <span style="margin-left: 20px;">üü¢ Alto Valor Social</span>
                        <span style="margin-left: 20px;">üîµ Alta Confianza</span>
                        <span style="margin-left: 20px;">‚ö™ Normal</span>
                    </div>
                </div>

                <div id="analyticsTab" class="tab-content">
                    <h2>Analytics & KPIs</h2>
                    <div class="stats-grid" id="analyticsGrid"></div>
                    <div class="section-title">Top Nodes por Categor√≠a</div>
                    <div id="topNodes"></div>
                </div>

                <div id="spawnTab" class="tab-content">
                    <h2>üéØ High-Value Node Spawn Analysis</h2>
                    <div id="spawnAnalysis"></div>
                </div>

                <div id="profileTab" class="tab-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2>Mi Perfil (OwnData)</h2>
                        <button class="btn btn-small" onclick="saveOwnData()">üíæ Guardar Perfil</button>
                    </div>

                    <form id="ownDataForm">
                        <div class="section-title">Informaci√≥n Personal</div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Hobbies Actuales</label>
                                <input type="text" id="ownHobbies" placeholder="Separados por comas">
                            </div>
                            <div class="form-group">
                                <label>Actividades Actuales</label>
                                <input type="text" id="ownCurrentActivities" placeholder="Qu√© est√°s haciendo ahora">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Estado Sentimental</label>
                                <select id="ownIsInLove">
                                    <option value="single">Soltero/a</option>
                                    <option value="dating">Saliendo con alguien</option>
                                    <option value="relationship">En una relaci√≥n</option>
                                    <option value="complicated">Es complicado</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Disponibilidad Social</label>
                                <select id="ownAvailability">
                                    <option value="high">Alta - Mucho tiempo libre</option>
                                    <option value="medium">Media - Algo de tiempo</option>
                                    <option value="low">Baja - Poco tiempo</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Trabajo/Estudios</label>
                            <input type="text" id="ownJob" placeholder="Tu ocupaci√≥n actual">
                        </div>

                        <div class="form-group">
                            <label>Objetivos a Largo Plazo</label>
                            <textarea id="ownLongTermGoals" placeholder="¬øQu√© quieres lograr en los pr√≥ximos a√±os?"></textarea>
                        </div>

                        <div class="form-group">
                            <label>Sue√±os Alcanzados</label>
                            <textarea id="ownDreamsAchieved" placeholder="¬øQu√© has logrado hasta ahora?"></textarea>
                        </div>

                        <div class="section-title">Auto-Evaluaci√≥n (1-10)</div>

                        <div class="form-group">
                            <label>Nivel de Involucramiento Social: <span id="ownInvolvementDisplay">5</span></label>
                            <input type="range" class="slider" id="ownInvolvement" min="1" max="10" value="5" oninput="updateOwnSlider('Involvement')">
                        </div>

                        <div class="form-group">
                            <label>Nivel de Fitness: <span id="ownFitnessDisplay">5</span></label>
                            <input type="range" class="slider" id="ownFitness" min="1" max="10" value="5" oninput="updateOwnSlider('Fitness')">
                        </div>

                        <div class="form-group">
                            <label>Nivel de Originalidad: <span id="ownOriginalityDisplay">5</span></label>
                            <input type="range" class="slider" id="ownOriginality" min="1" max="10" value="5" oninput="updateOwnSlider('Originality')">
                        </div>

                        <div class="form-group">
                            <label>Nivel de Ego√≠smo (honesto): <span id="ownEgoismDisplay">5</span></label>
                            <input type="range" class="slider" id="ownEgoism" min="1" max="10" value="5" oninput="updateOwnSlider('Egoism')">
                        </div>

                        <div class="form-group">
                            <label>Nivel de Inteligencia: <span id="ownIntelligenceDisplay">5</span></label>
                            <input type="range" class="slider" id="ownIntelligence" min="1" max="10" value="5" oninput="updateOwnSlider('Intelligence')">
                        </div>

                        <div class="form-group">
                            <label>Gusto Musical</label>
                            <input type="text" id="ownMusicTaste" placeholder="G√©neros, artistas favoritos...">
                        </div>

                        <div class="section-title">Estado Actual</div>
                        <div id="ownDataSummary" style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin-top: 15px;">
                            <p style="color: #666;">Guarda tu perfil para ver un resumen de tu estado actual.</p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Node Modal -->
    <div id="nodeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Gestionar Nodo</h2>
                <span class="close" onclick="closeNodeModal()">&times;</span>
            </div>
            <form id="nodeForm" onsubmit="saveNode(event)">
                <div class="form-group">
                    <label>Nombre *</label>
                    <input type="text" id="nodeName" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Edad</label>
                        <input type="number" id="nodeAge" min="0">
                    </div>
                    <div class="form-group">
                        <label>Color del Nodo</label>
                        <input type="color" id="nodeColor" class="color-picker" value="#3498db">
                    </div>
                </div>

                <div class="section-title">Atributos</div>

                <div class="form-group">
                    <label>Trabajo/Ocupaci√≥n</label>
                    <input type="text" id="nodeJob">
                </div>

                <div class="form-group">
                    <label>Hobbies (separados por comas)</label>
                    <input type="text" id="nodeHobbies" placeholder="Ej: M√∫sica, Deportes, Lectura">
                </div>

                <div class="form-group">
                    <label>Objetivos a largo plazo</label>
                    <textarea id="nodeLongTermGoals"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>¬øEst√° enamorado/a?</label>
                        <select id="nodeIsInLove">
                            <option value="no">No</option>
                            <option value="yes">S√≠</option>
                            <option value="unknown">Desconocido</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tipo de relaci√≥n cercana</label>
                        <select id="nodeRelationType">
                            <option value="">Selecciona...</option>
                            <option value="amigo">Amigo</option>
                            <option value="familia">Familia</option>
                            <option value="pareja">Pareja</option>
                            <option value="conocido">Conocido</option>
                            <option value="profesional">Profesional</option>
                        </select>
                    </div>
                </div>

                <div class="section-title">Heur√≠sticas & KPIs (1-10)</div>

                <div class="form-group">
                    <label>Valor Rom√°ntico: <span id="romanticValueDisplay">5</span></label>
                    <input type="range" class="slider" id="nodeRomanticValue" min="0" max="10" value="5" oninput="updateSlider('romanticValue')">
                </div>

                <div class="form-group">
                    <label>Valor Social (networking): <span id="socialValueDisplay">5</span></label>
                    <input type="range" class="slider" id="nodeSocialValue" min="0" max="10" value="5" oninput="updateSlider('socialValue')">
                </div>

                <div class="form-group">
                    <label>Nivel de Confianza: <span id="trustLevelDisplay">5</span></label>
                    <input type="range" class="slider" id="nodeTrustLevel" min="0" max="10" value="5" oninput="updateSlider('trustLevel')">
                </div>

                <div class="section-title">Lugares Predecibles</div>

                <div class="form-group">
                    <label>Lugares frecuentes (separados por comas)</label>
                    <input type="text" id="nodePlaces" placeholder="Ej: Universidad, Bar Central, Gimnasio">
                </div>

                <div class="form-group">
                    <label>Highlights / Notas importantes</label>
                    <textarea id="nodeHighlights" placeholder="Cualquier informaci√≥n relevante sobre esta persona..."></textarea>
                </div>

                <button type="submit" class="btn">üíæ Guardar Nodo</button>
                <button type="button" class="btn btn-danger btn-small" onclick="deleteNode()" id="deleteNodeBtn" style="display:none; margin-left: 10px;">üóëÔ∏è Eliminar</button>
            </form>
        </div>
    </div>

    <!-- Event Modal -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Gestionar Evento</h2>
                <span class="close" onclick="closeEventModal()">&times;</span>
            </div>
            <form id="eventForm" onsubmit="saveEvent(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>Fecha *</label>
                        <input type="date" id="eventDate" required>
                    </div>
                    <div class="form-group">
                        <label>Hora</label>
                        <input type="time" id="eventTime">
                    </div>
                </div>

                <div class="form-group">
                    <label>Nodos participantes *</label>
                    <select id="eventNodes" multiple size="5" required style="height: 120px;">
                    </select>
                    <small style="color: #666;">Mant√©n Ctrl/Cmd para seleccionar m√∫ltiples</small>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Lugar *</label>
                        <input type="text" id="eventPlace" required>
                    </div>
                    <div class="form-group">
                        <label>Clima</label>
                        <select id="eventWeather">
                            <option value="">Selecciona...</option>
                            <option value="soleado">‚òÄÔ∏è Soleado</option>
                            <option value="nublado">‚òÅÔ∏è Nublado</option>
                            <option value="lluvioso">üåßÔ∏è Lluvioso</option>
                            <option value="nevado">‚ùÑÔ∏è Nevado</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Outfit</label>
                        <input type="text" id="eventOutfit" placeholder="Ej: Camisa azul, jeans">
                    </div>
                    <div class="form-group">
                        <label>N√∫mero de personas</label>
                        <input type="number" id="eventPeopleCount" min="1">
                    </div>
                </div>

                <div class="form-group">
                    <label>Situaci√≥n/Objetivo</label>
                    <input type="text" id="eventSituation" placeholder="Ej: Cena casual, Networking, Estudio">
                </div>

                <div class="form-group">
                    <label>Ambiente/Environment</label>
                    <textarea id="eventEnvironment" placeholder="Describe el ambiente, ruido, iluminaci√≥n, etc."></textarea>
                </div>

                <div class="form-group">
                    <label>Notas del evento</label>
                    <textarea id="eventNotes"></textarea>
                </div>

                <button type="submit" class="btn">üíæ Guardar Evento</button>
                <button type="button" class="btn btn-danger btn-small" onclick="deleteEventFromModal()" id="deleteEventBtn" style="display:none; margin-left: 10px;">üóëÔ∏è Eliminar</button>
            </form>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
